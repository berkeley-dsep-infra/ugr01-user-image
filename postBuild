#!/usr/bin/env bash

set -e

# installing chromium browser to enable webpdf conversion using nbconvert
export PLAYWRIGHT_BROWSERS_PATH=${CONDA_DIR}
playwright install chromium
      for notebook in image-tests/*.ipynb; do
          jupyter nbconvert --to webpdf "$notebook"
          if [ ! -f "${notebook%.ipynb}.pdf" ]; then
              echo "Error: PDF conversion failed for $notebook"
              exit 1
          fi
      done

# Test if notebook can be converted to pdf
for notebook in image-tests/*.ipynb; do
    jupyter nbconvert --to webpdf "$notebook"
    if [ ! -f "${notebook%.ipynb}.pdf" ]; then
        echo "Error: PDF conversion failed for $notebook"
        exit 1
    fi
done

# Test if notebook can be converted to pdf
for notebook in image-tests/*.ipynb; do
    jupyter nbconvert --to webpdf "$notebook"
    if [ ! -f "${notebook%.ipynb}.pdf" ]; then
        echo "Error: PDF conversion failed for $notebook"
        exit 1
    fi
done

# Test if notebook can be converted to pdf
for notebook in image-tests/*.ipynb; do
    jupyter nbconvert --to webpdf "$notebook"
    if [ ! -f "${notebook%.ipynb}.pdf" ]; then
        echo "Error: PDF conversion failed for $notebook"
        exit 1
    fi
done
